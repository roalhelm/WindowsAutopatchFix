Windows Autopatch

ï¿¼

Legend & References (what each component does)
* Windows Autopatch Client Broker: onâ€‘demand agent to perform device readiness checks and automated log collection for support; managed from Intune â†’ Tenant administration â†’ Windows Autopatch â†’ Tenant management â†’ Manage client broker. Since Septâ€¯22,â€¯2025, installation defaults to a Win32 app; PowerShell install remains available. [learn.microsoft.com], [learn.microsoft.com]
* Windows Autopatch Client Broker Upgrader: invoked for feature upgrade orchestration (setup phases) rather than monthly quality updates; Autopatch runs multiâ€‘phase feature releases with ring control. [learn.microsoft.com]
* Intune Management Extension (IME): executes PowerShell / Win32 appâ€“based remediations and deployments used by Autopatch (e.g., readiness scripts, remediation for policy conflicts). [learn.microsoft.com], [learn.microsoft.com]
* Windows Update client policies / Windows Update for Business (WUfB): controls offering, deferrals, deadlines, ring rollout for quality & feature updates. [learn.microsoft.com]
* Windows Update Agent (WUA): the system downloads and installs update payloads via API/workflows; installation events and status are recorded in logs. [learn.microsoft.com]
* Delivery Optimization (DO): performs P2P and cacheâ€‘assisted content distribution to reduce bandwidth when WUA downloads updates/upgrades. [learn.microsoft.com], [learn.microsoft.com]
* Connected User Experiences & Telemetry (DiagTrack): sends diagnostic/telemetry used for Autopatch and update reporting/compliance signals. [learn.microsoft.com]
* Windows Autopatch service (cloud orchestration in Intune): manages rings, release schedules, reporting, and readiness checks across devices. [learn.microsoft.com], [learn.microsoft.com]
* Windows Setup / SetupDiag (Feature Update only): Setup.exe executes Downlevel â†’ SafeOS â†’ First Boot â†’ Second Boot phases; SetupDiag analyzes failures automatically. [learn.microsoft.com], [github.com]
Note: LTSC devices are managed for quality updates only; feature updates arenâ€™t offered via Autopatch/WU client policies. [learn.microsoft.com], [video2.ski...cademy.com]

Diagram 1 â€” Quality Update process (includes all components)
(Rendered above. It shows: Autopatch service schedules â†’ device assignment/rings â†’ IME & readiness â†’ WUA offer â†’ Client Broker coordinates & reports â†’ DO assists download â†’ install â†’ telemetry reporting/compliance.)

ğŸ–¼ï¸ Diagram 2 â€” Feature Update process (includes all components)
Iâ€™ll generate the second chart nowâ€”Feature Update endâ€‘toâ€‘end, including Client Broker Upgrader and Windows Setup / SetupDiag.


Wichtige Systemkomponenten im Autopatch-Prozess
1. Windows Autopatch Client Broker
    * Kernkomponente fÃ¼r Kommunikation mit dem Autopatch-Dienst.
    * Steuert Update- und Upgrade-AblÃ¤ufe.
2. Windows Autopatch Client Broker Upgrader
    * Aktiv bei Feature-Upgrades (z.â€¯B. 22H2 â†’ 24H2).
    * FÃ¼hrt Setup.exe aus und Ã¼berwacht Upgrade-Phasen.
3. Intune Management Extension (IME)
    * FÃ¼hrt Skripte und Remediation-Aufgaben aus.
    * Wird fÃ¼r Autopatch-Registrierung und Policy-Anwendung genutzt.
4. Windows Update Agent (WUA)
    * Verantwortlich fÃ¼r den Download und die Installation von Updates.
    * Arbeitet mit WUfB (Windows Update for Business).
5. Delivery Optimization Service
    * Optimiert die Verteilung von Update-Paketen (Peer-to-Peer).
6. Microsoft Connected User Experiences and Telemetry (DiagTrack)
    * Sendet Telemetrie-Daten an Autopatch fÃ¼r Status und Fehleranalyse.
7. Autopatch Orchestrator (Cloud)
    * Kein lokaler Dienst, aber wichtig: steuert die Ringe und ZeitplÃ¤ne aus der Cloud.

ğŸ’¡ FÃ¼r Feature Updates ist zusÃ¤tzlich der Setup Engine (Windows Setup.exe) beteiligt, der vom Upgrader angestoÃŸen wird.



ï¿¼
error-handling paths included:
1. Quality Update process (monthly cumulative updates) â€“ includes:â€¨Autopatch service (cloud), Intune Management Extension (IME), Windows Autopatch Client Broker, Windows Update Agent (WUA), Delivery Optimization, and Connected User Experiences & Telemetry (DiagTrack).â€¨Error branches cover: device not ready, policy conflicts, network/DO fallback, WUA download/install errors, and Autopatch release pause.
2. Feature Update process (OS inâ€‘place upgrade) â€“ includes all above plus Client Broker Upgrader and Windows Setup/SetupDiag; error branches cover: preâ€‘check failure, Setup phase failures (SafeOS/First/Second Boot), automatic rollback, Autopatch pause/safeguard, and support log collection.

Error-handling paths (concise guide)
Quality Updates
* Device Not Ready â†’ Remediate via IME scripts (remove GPO/ConfigMgr conflicts, ensure recent Intune check-in); Autopatch Device Readiness reports show causes and next actions. îˆ€citeîˆ‚Postâ€‘device registration readiness checksîˆ‚Start using Windows Autopatch
* Policy conflicts (WUfB/GPO/ConfigMgr) â†’ Detect & fix with remediation scripts via Intune (IME). îˆ€citeîˆ‚Windows Update client policies (formerly WUfB)îˆ‚Intune IME & scripts
* Network/Delivery Optimization issues â†’ DO falls back to HTTP source; verify endpoints/ports and proxy bypass for DO service. îˆ€citeîˆ‚What is Delivery Optimizationîˆ‚Configure DO & endpoints
* WUA download/installation errors â†’ Inspect WindowsUpdateClient events; retry via Autopatch ring schedule; pause release if necessary. îˆ€citeîˆ‚Windows Update Agent APIîˆ‚Quality update release overview
Feature Updates
* Preâ€‘check/Readiness fail (hardware, storage, BitLocker policy, etc.) â†’ Autopatch marks Not Ready; remediate and re-evaluate. îˆ€citeîˆ‚Feature update overview & phasesîˆ‚Readiness checks
* Setup phase failure (Downlevel/SafeOS/First/Second Boot) â†’ SetupDiag runs automatically to identify the root cause; perform corrective action (e.g., EFI/system partition conflicts, drivers), then retry. îˆ€citeîˆ‚SetupDiagîˆ‚Windows upgrade phases explained
* Automatic rollback â†’ Windows Setup reverts to previous OS if fatal error; review SetupDiagResults.xml and Panther logs; retry after fix. îˆ€citeîˆ‚SetupDiag
* Autopatch pause / safeguard holds â†’ Service can pause rings or hold content based on telemetry signals; resume after Microsoft publishes mitigations. îˆ€citeîˆ‚Start using Autopatch (release & reporting)îˆ‚Feature update release statuses
* Support log collection â†’ The Client Broker enables automated log collection when you file a support request via Intuneâ€™s Help & Support. îˆ€citeîˆ‚Client Broker (install & support logs)îˆ‚Submit a support request

Notes for your UEM TaskForce (based on your role)
* For 24H2 rollouts, use multiâ€‘phase releases and leverage Device Readiness to preâ€‘empt failures. Add IME remediation for common blockers (e.g., legacy WU settings, storage thresholds). îˆ€citeîˆ‚Feature update multiâ€‘phaseîˆ‚Readiness checks
* Keep Client Broker deployed tenantâ€‘wide; itâ€™s now a Win32 app for reliable install and onâ€‘demand scoped deployments. îˆ€citeîˆ‚Client Broker docs
